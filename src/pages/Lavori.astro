---
// /blog/index.astro
import { sanityClient } from "sanity:client";
import SanityImage from "../components/SanityImage.astro";
import Layout from "../layouts/Layout.astro";

const posts = await sanityClient.fetch(
  `*[_type == "lavoro"] {
    name,
    foto
  }`
);
---

<Layout title="Prodotti">
  <div
    class="grid grid-cols-1 md:grid-cols-2 gap-2 justify-center items-center align-center w-full h-full"
  >
    {
      posts.map((post: any) => {
        if (post.foto) {
          return post.foto.map((element: any) => {
            console.log(element);
            const image = element.asset._ref;
            const imageUrl = image.split("-");
            const width = Number(imageUrl[imageUrl.length - 2].split("x")[0]);
            const height = Number(imageUrl[imageUrl.length - 2].split("x")[1]);
            console.log(imageUrl[imageUrl.length - 2]);
            console.log(width);
            console.log(height);
            console.log((width * 400) / height);
            return (
              <div class="flex justify-center items-center align-center">
                <div
                  class={
                    "flex relative items-center align-center justify-center"
                  }
                  style={{
                    width: 400 + "px",
                    height: (height * 400) / width + "px",
                  }}
                >
                  <SanityImage node={element} width={400} />
                  <div
                    class="px-8 py-10 relative z-10 w-full border-4 border-gray-200 bg-white opacity-0 hover:opacity-100 flex items-center justify-center"
                    style={{
                      width: 400 + "px",
                      height: (height * 400) / width + "px",
                    }}
                    onclick=""
                  >
                    <h1 class="title-font text-4xl font-medium text-gray-900 mb-3 text-center">
                      {post.name}
                    </h1>
                  </div>
                </div>
              </div>
            );
          });
        }
      })
    }
  </div>
</Layout>
<!-- <div class="px-8 py-10 relative z-10 w-full border-4 border-gray-200 bg-white opacity-0 hover:opacity-100 flex items-center justify-center">
            <h1 class="title-font text-4xl font-medium text-gray-900 mb-3 text-center">
              {post.name}
            </h1>
                // style={{
            //   width: width + "px",
            //   height: height + "px",
            // }}
          </div> -->
